"use strict";var be=Object.create;var H=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var xe=Object.getPrototypeOf,Se=Object.prototype.hasOwnProperty;var Ne=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),Ye=(e,n)=>{for(var r in n)H(e,r,{get:n[r],enumerable:!0})},X=(e,n,r,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of Te(n))!Se.call(e,t)&&t!==r&&H(e,t,{get:()=>n[t],enumerable:!(s=$e(n,t))||s.enumerable});return e};var Q=(e,n,r)=>(r=e!=null?be(xe(e)):{},X(n||!e||!e.__esModule?H(r,"default",{value:e,enumerable:!0}):r,e)),He=e=>X(H({},"__esModule",{value:!0}),e);var k=Ne((it,E)=>{var Pe=/[<"'&]/,Ie=/[a-z][A-Z]/;function _(e,n){let r=e.charCodeAt(n);return r>=65&&r<=90}function ne(e){if(!Ie.test(e))return e;let n=e.length,r=0,s=0,t="",i=!0,u=_(e,0),a;for(;s<n;s++)a=_(e,s+1),!i&&u&&!a&&(t+=e.slice(r,s)+"-"+e[s].toLowerCase(),r=s+1),i=u,u=a;return t+=e.slice(r,s),t}function ee(e,...n){let r=e.length,s=n.length,t=0,i="";for(;t<r;t++)i+=e[t],t<s&&(i+=n[t]);return P(i)}var P=function(e){if(typeof e!="string"&&(e=e.toString()),!Pe.test(e))return e;let n=e.length,r="",s=0,t=0;for(;t<n;t++)switch(e[t]){case"&":r+=e.slice(s,t)+"&amp;",s=t+1;continue;case"<":r+=e.slice(s,t)+"&lt;",s=t+1;continue;case'"':r+=e.slice(s,t)+"&#34;",s=t+1;continue;case"'":r+=e.slice(s,t)+"&#39;",s=t+1;continue}return r+=e.slice(s,t),r};typeof Bun<"u"&&(P=Bun.escapeHTML);function re(e){return e==="meta"||e==="link"||e==="img"||e==="br"||e==="input"||e==="hr"||e==="area"||e==="base"||e==="col"||e==="command"||e==="embed"||e==="keygen"||e==="param"||e==="source"||e==="track"||e==="wbr"}function se(e){if(typeof e=="string"){let c=e.indexOf('"');if(c===-1)return e;let o=e.length,f="",m=0;for(;c<o;c++)e[c]==='"'&&(f+=e.slice(m,c)+"&#34;",m=c+1);return f+=e.slice(m,c),f}let n=Object.keys(e),r=n.length,s,t,i,u,a=0,l="";for(;a<r;a++){if(s=n[a],t=e[s],t==null)continue;if(l+=ne(s)+":",typeof t!="string"){l+=t.toString()+";";continue}if(i=t.indexOf('"'),i===-1){l+=t+";";continue}let c=t.length;for(u=0;i<c;i++)t[i]==='"'&&(l+=t.slice(u,i)+"&#34;",u=i+1);l+=t.slice(u,i)+";"}return l}function Z(e){let n=Object.keys(e),r=n.length,s,t,i,u,a,l,c,o="",f=0;for(;f<r;f++)if(s=n[f],!(s==="children"||s==="safe")){if(t=e[s],s==="className"){if(e.class!==void 0)continue;s="class"}else if(s==="class"&&Array.isArray(t)){l=t,c=t.length,t="";for(let m=0;m<c;m++)l[m]&&l[m].length>0&&(t?t+=" "+l[m].trim():t+=l[m].trim());if(t.length===0)continue}else if(s==="style"){o+=' style="'+se(t)+'"';continue}else if(s==="attrs"){typeof t=="string"?o+=" "+t:o+=Z(t);continue}if(i=typeof t,i==="boolean"){t&&(o+=" "+s);continue}if(t!=null){if(o+=" "+s,i!=="string"){if(i!=="object"){o+='="'+t.toString()+'"';continue}if(t instanceof Date){o+='="'+t.toISOString()+'"';continue}t=t.toString()}if(u=t.indexOf('"'),u===-1){o+='="'+t+'"';continue}for(o+='="',c=t.length,a=0;u<c;u++)t[u]==='"'&&(o+=t.slice(a,u)+"&#34;",a=u+1);o+=t.slice(a,u)+'"'}}return o}function j(e,n){let r=e.length,s="",t,i=0;for(;i<r;i++){if(t=e[i],typeof t!="string"){if(!t&&t!==0)continue;if(t.then)return Promise.all(e.slice(i)).then(function(a){return a.unshift(s),j(a,n)});if(Array.isArray(t)){e.splice(i--,1,...t),r+=t.length-1;continue}}s+=t}return n===!0?P(s):s}function te(e,n,...r){let s=n!==null;if(typeof e=="function")return s?n.children===void 0&&(n.children=r.length>1?r:r[0]):n={children:r.length>1?r:r[0]},e(n);s&&e==="tag"&&(e=String(n.of),delete n.of);let t=s?Z(n):"";if(r.length===0&&re(e))return"<"+e+t+"/>";let i=j(r,s&&n.safe);return typeof i=="string"?"<"+e+t+">"+i+"</"+e+">":i.then(function(a){return"<"+e+t+">"+a+"</"+e+">"})}function Ee(e){return I.contentsToString([e.children])}function ke(e,n=!0,r="/*\0*/"){if(typeof e!="function")throw new Error("The first argument must be a function.");let s=new Set,t=e(new Proxy({},{get(o,f){s.add(f);let m=f==="children",g=`args[${r}\`${f.toString()}\`${r}]`;return m&&(g=`Array.isArray(${g}) ? ${g}.join(${r}\`\`${r}) : ${g}`),`\`${r} + (${g} || ${n&&!m?`throwPropertyNotFound(${r}\`${f.toString()}\`${r})`:`${r}\`\`${r}`}) + ${r}\``}}));if(typeof t!="string")throw new Error("You cannot use compile() with async components.");let i=r.length,u=t.length,a="",l=0,c=0;for(;c<u;c++)if(t[c]==="`"&&t.slice(c-i,c)!==r&&t.slice(c+1,c+i+1)!==r){a+=t.slice(l,c)+"\\`",l=c+1;continue}return a+=t.slice(l),n?Function("args",`if (args === undefined) { throw new Error("The arguments object was not provided.") };
function throwPropertyNotFound(name) { throw new Error("Property " + name + " was not provided.") };
return \`${a}\``):Function("args",`if (args === undefined) { args = Object.create(null) };
return \`${a}\``)}var I={escape:ee,e:ee,escapeHtml:P,isVoidElement:re,attributesToString:Z,toKebabCase:ne,isUpper:_,styleToString:se,createElement:te,h:te,contentsToString:j,compile:ke,Fragment:Ee};E.exports=I;E.exports.Html=I;E.exports.default=I});var nt={};Ye(nt,{handlers:()=>tt});module.exports=He(nt);var L=Q(k()),ie={messages:{insert:[{handler:async(e,n)=>({receivers:(await n.query.users.findMany()).map(t=>t.userId).filter(t=>t!==e.userId),message:Html.createElement("div",{id:"messages","hx-swap-oob":"beforeend"},Html.createElement("div",null,(0,L.escapeHtml)(e.messageText)))}),type:"htmx",name:"Send message to all users except sender"},{handler:e=>({receivers:[e.userId],message:Html.createElement("div",{id:"messages","hx-swap-oob":"beforeend"},Html.createElement("div",{style:"color: red;"},(0,L.escapeHtml)(e.messageText)))}),type:"htmx",name:"Send message to sender"}]}};var d=require("drizzle-orm/pg-core"),ut=(0,d.pgTable)("atdatabases_migrations_version",{id:(0,d.integer)("id").primaryKey().notNull(),version:(0,d.text)("version")}),ct=(0,d.pgTable)("atdatabases_migrations_applied",{id:(0,d.bigserial)("id",{mode:"bigint"}).primaryKey().notNull(),index:(0,d.integer)("index").notNull(),name:(0,d.text)("name").notNull(),script:(0,d.text)("script").notNull(),appliedAt:(0,d.timestamp)("applied_at",{withTimezone:!0,mode:"string"}).notNull(),ignoredError:(0,d.text)("ignored_error"),obsolete:(0,d.boolean)("obsolete").notNull()}),ft=(0,d.pgTable)("_trigs_ddl_log",{id:(0,d.integer)("id").primaryKey().notNull(),username:(0,d.text)("username"),objectTag:(0,d.text)("object_tag"),ddlCommand:(0,d.text)("ddl_command"),timestamp:(0,d.timestamp)("timestamp",{mode:"string"})}),F=(0,d.pgTable)("messages",{messageId:(0,d.uuid)("message_id").defaultRandom().primaryKey().notNull(),userId:(0,d.uuid)("user_id").notNull().references(()=>A.userId,{onDelete:"cascade"}),messageText:(0,d.text)("message_text").notNull(),createdAt:(0,d.timestamp)("created_at",{withTimezone:!0,mode:"string"}).defaultNow()}),A=(0,d.pgTable)("users",{userId:(0,d.uuid)("user_id").defaultRandom().primaryKey().notNull(),username:(0,d.varchar)("username",{length:255}).notNull(),email:(0,d.varchar)("email",{length:255}).notNull(),createdAt:(0,d.timestamp)("created_at",{withTimezone:!0,mode:"string"}).defaultNow(),updatedAt:(0,d.timestamp)("updated_at",{withTimezone:!0,mode:"string"}).defaultNow()},e=>({usersEmailKey:(0,d.unique)("users_email_key").on(e.email)}));var pe=require("drizzle-orm");var fe=/^([0-9]{4})-([0-1][0-9])(?:-([0-3][0-9]))?(?:[T ]?([0-2][0-9])(?::([0-5][0-9]))?(?::([0-5][0-9]))?)?(?:\.[0-9]+)?(Z|(?:\+|\-)[0-9]{4})?$/;function Fe(e){let n=e.match(fe);if(n){let r=Number(n[2]);if(r<1||r>12)return!1;if(typeof n[3]!==void 0){let s=Number(n[3]);if(s<1||s>31)return!1}if(typeof n[4]!==void 0){let s=Number(n[4]);if(s<0||s>23)return!1}return!0}return!1}function Ae(e){let n=e.match(fe);return n&&typeof n[4]>"u"?e+="T00:00:00":e}function T(e){if(e||(e=new Date),e instanceof Date){let n=new Date(e);return n.setMilliseconds(0),n}if(e=e.trim(),Fe(e))return new Date(Ae(e));throw new Error(`Non ISO 8601 compliant date (${e}).`)}function Ce(e){let n=T(e);return n.setDate(1),n.setMonth(n.getMonth()+1),n.setDate(0),n}function _e(e){return Ce(e).getDate()}var W="1999-03-04T02:05:01.000Z",U=new Map,O=[["YYYY",{year:"numeric"}],["YY",{year:"2-digit"}],["MMMM",{month:"long"}],["MMM",{month:"short"}],["MM",{month:"2-digit"}],["M",{month:"numeric"}],["DD",{day:"2-digit"}],["D",{day:"numeric"}],["dddd",{weekday:"long"}],["ddd",{weekday:"short"}],["d",{weekday:"narrow"}],["mm",{minute:"2-digit"}],["m",{minute:"numeric"}],["ss",{second:"2-digit"}],["s",{second:"numeric"}],["Z",{timeZoneName:"short"}]],z=[["HH",{hour:"2-digit"}],["H",{hour:"numeric"}]],R=[["hh",{hour:"2-digit"}],["h",{hour:"numeric"}],["a",{dayPeriod:"narrow"}],["A",{dayPeriod:"narrow"}]],C={DD:2,HH:2,MM:2,YY:2,YYYY:4,hh:2,mm:2,ss:2,Z:5},Ze=["MMMM","MMM","dddd","ddd"],h=new Map([...O,...z,...R].map(e=>[e[0],e])),ae=new Map,le=["full","long","medium","short"],b=e=>String(e).padStart(2,"0"),K=e=>String(e).padStart(2,"0");function D(e){return e.type==="literal"&&(e.value=e.value.normalize("NFKC")),e}function je(e,n,r,s=!1){let t=Le(e,n,r,s),i=T(e);function u({partName:a,partValue:l,token:c}){if(a==="literal")return l;let o=t[a];if(a==="hour"&&c==="H")return o.replace(/^0/,"");if((a==="minute"||a==="second")&&(c==="mm"||c==="ss")&&o.length===1)return`0${o}`;if(a==="dayPeriod"){let f=N(i.getHours()<12?"am":"pm",r);return c==="A"?f.toUpperCase():f.toLowerCase()}return a==="timeZoneName"?de(-1*i.getTimezoneOffset()):o}return n.map(a=>({...a,value:u(a)}))}function Le(e,n,r,s=!1){let t=T(e),i=n.filter(o=>o.hour12),u=n.filter(o=>!o.hour12),a=[],l=[];function c(o,f=!1){let m=`${r}-u-hc-${f?"h12":"h23"}`;if(a.push(...new Intl.DateTimeFormat(m,o.reduce((g,p)=>p.partName==="literal"?g:(s&&Ze.includes(p.token)&&l.push(p),Object.assign(g,p.option)),{})).formatToParts(t).map(D)),s&&l.length)for(let g of l){let p=[];switch(g.token){case"MMMM":p=new Intl.DateTimeFormat(m,{dateStyle:"long"}).formatToParts(t).map(D);break;case"MMM":p=new Intl.DateTimeFormat(m,{dateStyle:"medium"}).formatToParts(t).map(D);break}let y=p.find(M=>M.type===g.partName),S=a.findIndex(M=>M.type===g.partName);y&&S>-1&&(a[S]=y)}}return i.length&&c(i,!0),u.length&&c(u),a.reduce((o,f)=>(o[f.type]=f.value,o),{})}function de(e){let n=String(Math.floor(Math.abs(e/60))).padStart(2,"0"),r=String(Math.abs(e%60)).padStart(2,"0");return`${e<0?"-":"+"}${n}${r}`}function Ue(e){me(e);let[n,r,s,t]=e.match(/([+-])([0-3][0-9])([0-6][0-9])/),i=Number(s)*60+Number(t);return r==="+"?i:-i}function me(e){if(!/^([+-])[0-3][0-9][0-6][0-9]$/.test(e))throw new Error(`Invalid offset: ${e}`);return e}function Ke(e){return O.concat(z).concat(R).sort((n,r)=>n[0].length>r[0].length?1:-1).reduce((n,r)=>n.replace(r[0],`\\${r[0]}`),e)}function We(e){return["numeric","2-digit"].includes(e.partValue)}function Oe(e){let n;for(let r of e){if(r.partName==="literal"&&!isNaN(parseFloat(r.partValue)))throw new Error(`Numbers in format (${r.partValue}).`);if(n&&n.partName!=="literal"&&r.partName!=="literal"&&!(n.token in C)&&!(r.token in C)&&!(We(n)&&r.token.toLowerCase()==="a"))throw new Error(`Illegal adjacent tokens (${n.token}, ${r.token})`);n=r}return e}function N(e,n){let r=ae.get(n);if(r&&r[e])return r[e];let s=new Date(W);s.setUTCHours(e==="am"?5:20);let i=new Intl.DateTimeFormat(n,{timeStyle:"full",timeZone:"UTC",hour12:!0}).formatToParts(s).map(D).find(u=>u.type==="dayPeriod");if(i){let u=r||{};return ae.set(n,Object.assign(u,{[e]:i.value})),i.value}return e}function ze(e,n="+0000"){let r=T(e),s=Ue(n);return new Date(r.getTime()+s*1e3*60)}function Re(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function ue(e,n){let r=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:n,hourCycle:"h23"}).formatToParts(e).map(D),s={};return r.forEach(t=>{s[t.type]=t.value}),new Date(`${s.year}-${s.month}-${s.day}T${s.hour}:${s.minute}:${s.second}Z`)}function qe(e,n="UTC",r="device"){r=r==="device"?Re():r;let s=T(e),t=ue(s,n),u=(ue(s,r).getTime()-t.getTime())/1e3/60;return de(u)}function q(e,n){if(le.includes(e)||typeof e=="object")return Ve(e,n);let r=e,s=0,t=o=>{if(o[2]||(o[2]=new RegExp(`(.)?(${o[0]})`,"g")),o[2].test(r)){let f=0;return r=r.replace(o[2],(m,g,p)=>g==="\\"?p:`${typeof g=="string"?g:""}{!${f++?s:s++}!}`),!!f}return!1};function i(o){let f=o.map(g=>g.partName),m=new Set(f);if(f.length>m.size)throw new Error("Cannot reuse format tokens.");return o}function u(o,[f,m,g]){let p=Object.keys(m)[0],y=m[p];return{option:m,partName:p,partValue:y,token:f,pattern:g,hour12:o}}let a=O.filter(t).concat(z.filter(t)).map(u.bind(null,!1)),l=i(a.concat(R.filter(t).map(u.bind(null,!0)))),c=/^\{!(\d+)!\}$/;return r.split(/(\{!\d+!\})/).map(o=>{let f=o.match(c);return f?l[Number(f[1])]:{option:{literal:o},partName:"literal",partValue:o,token:o,pattern:new RegExp(""),hour12:!1}}).filter(o=>!(o.partName==="literal"&&o.partValue===""))}function Ve(e,n){let r={timeZone:"UTC"};typeof e=="string"?r.dateStyle=e:("date"in e&&(r.dateStyle=e.date),"time"in e&&(r.timeStyle=e.time));let s=new Intl.DateTimeFormat(n,r),t=s.formatToParts(new Date(W)).map(D),u=s.formatToParts(new Date("1999-04-05T23:05:01.000Z")).map(D).find(l=>l.type==="hour"),a=u&&u.value==="23"?24:12;return t.map(l=>{let c=l.type,o=Be(l.type,l.value,n,l.type==="hour"?a:void 0);if(o===void 0)return;let f=o[1][c];if(f)return o[2]||(o[2]=new RegExp(`${o[0]}`,"g")),{option:{[c]:f},partName:c,partValue:f,token:o[0],pattern:o[2],hour12:a===12}}).filter(l=>!!l)}function Be(e,n,r,s){let t=n.length,i=!isNaN(Number(n)),u;switch(e){case"year":return t===2?h.get("YY"):h.get("YYYY");case"month":if(i)return t===1?h.get("M"):h.get("MM");switch(u=ce(r,e,n),u){case"long":return h.get("MMMM");default:return h.get("MMM")}case"day":return t===1?h.get("D"):h.get("DD");case"weekday":switch(u=ce(r,e,n),u){case"narrow":return h.get("d");case"short":return h.get("ddd");default:return h.get("dddd")}case"hour":return s===12?t===1?h.get("h"):h.get("hh"):t===1?h.get("H"):h.get("HH");case"minute":return t===1?h.get("m"):h.get("mm");case"second":return t===1?h.get("s"):h.get("ss");case"dayPeriod":return/^[A-Z]+$/u.test(n)?h.get("A"):h.get("a");case"literal":return[n,{literal:n},new RegExp("")];case"timeZoneName":let a=n.split("-");return a.length===2&&a[1].length===4?h.get("ZZ"):h.get("Z");default:return}}function ce(e,n,r){if(!U.has(e)){let t=new Date(W),i=[3,8,9,7,6,4,3],u=["weekday","month","dayPeriod"],a=["long","short","narrow"],l={};for(let c=0;c<12;c++){t.setMonth(0+c),c in i&&t.setDate(i[c]),t.setUTCHours(8+c);for(let o of a){let f=new Intl.DateTimeFormat(e,u.reduce((m,g)=>Object.assign(m,{[g]:o}),{hour12:!0,timeZone:"UTC"})).formatToParts(t).map(D);if(o==="long"||o==="short"){let g=new Intl.DateTimeFormat(e,{dateStyle:o==="short"?"medium":"long"}).formatToParts(t).map(D).find(y=>y.type==="month"),p=f.findIndex(y=>y.type==="month");p>-1&&g&&(f[p]=g)}f.forEach(m=>{if(m.type==="literal")return;let g=m.type;l[g]=Object.assign(l[g]||{},{[m.value]:o})})}}U.set(e,l)}let s=U.get(e);return s?s[n][r]:void 0}function Ge(e,n="+0000"){let r=n.slice(0,1)==="+";return ze(e,n.replace(r?"+":"-",r?"-":"+"))}function Je(){return Intl.DateTimeFormat().resolvedOptions().locale}function $(e,n="long",r="device",s=!1,t){let i;return typeof e=="object"&&!(e instanceof Date)&&({date:e,format:n,locale:r,genitive:s,partFilter:t,tz:i}=e),n==="ISO8601"?T(e).toISOString():(i&&(e=Ge(e,qe(e,i))),(!r||r==="device")&&(r=Je()),je(e,q(n,r).filter(t??(()=>!0)),r,s).map(u=>u.value).join(""))}function Xe(e,n="en",r=!1,s=()=>!0){return q(e,n).filter(s).reduce((t,i)=>t+=r&&i.partName==="literal"?Ke(i.token):i.token,"").normalize("NFKC")}function Qe(e){let n=new Date().getFullYear(),r=n%100,s=Math.floor(n/100),t=Number(e);return(s+(t>r+20?-1:0))*100+t}function ge(e,n="en",r=!1){let s=(t,i)=>Array(t).fill("").map((u,a)=>`${i(a)}`);if(e==="M")return s(12,t=>t+1);if(e==="MM")return s(12,t=>{let i=t+1;return i<10?`0${i}`:i});if(e.startsWith("M"))return ge("MM").map(t=>$(`2000-${t}-05`,e,n,r));if(e.startsWith("d"))return s(7,t=>`0${t+2}`).map(t=>$(`2022-10-${t}`,e,n));if(e==="a")return[N("am",n).toLowerCase(),N("pm",n).toLowerCase()];if(e==="A")return[N("am",n).toUpperCase(),N("pm",n).toUpperCase()];if(e.startsWith("Y")){let t=new Date().getFullYear();return s(120,i=>i+1).reduce((i,u)=>(u!=="120"&&i.push($(`${t+Number(u)}-06-06`,e,n)),i.unshift($(`${t-Number(u)}-06-06`,e,n)),i),[$(`${t}-06-06`,e,n)])}return e.startsWith("D")?s(31,t=>`${e==="DD"&&t<9?"0":""}${t+1}`):e.startsWith("H")?s(24,t=>`${e==="HH"&&t<10?"0":""}${t}`):e.startsWith("h")?s(12,t=>`${e==="hh"&&t<9?"0":""}${t+1}`):e.startsWith("m")||e.startsWith("s")?s(60,t=>`${e.length>1&&t<10?"0":""}${t}`):[]}function he(e,n="ISO8601",r="device"){let s=()=>!0,t,i="backward";if(typeof e=="object"?{date:t,format:n="ISO8601",locale:r="device",dateOverflow:i="backward",partFilter:s=()=>!0}=e:t=e,!t)throw new Error("parse() requires a date string.");let u=()=>{throw new Error(`Date (${t}) does not match format (${Xe(n,r)})`)};if(n==="ISO8601")return T(t);let a=le.includes(n)||typeof n=="object",l=Oe(q(n,r).filter(s));if(!l.length)throw new Error("parse() requires a pattern.");let c;try{c=et(t,l)}catch{return u()}let o=new Date,f=new Map([["YYYY",o.getFullYear()],["MM",o.getMonth()+1],["DD",o.getDate()],["HH",0],["mm",0],["ss",0]]),m=null,g="";c.forEach(w=>{if(w.partName==="literal")return;if(w.token===w.value)return u();let Y=Number(w.value);if(f.has(w.token))f.set(w.token,Y);else if(w.token==="YY")f.set("YYYY",Qe(w.value));else{let v=w.token;if(v.startsWith("d"))return;if(v==="D")f.set("DD",Y);else if(v==="H"||v.startsWith("h"))f.set("HH",Y);else if(v==="M")f.set("MM",Y);else if(v==="a"||v==="A")m=w.value.toLowerCase()===N("am",r).toLowerCase();else if(v==="Z")g=me(w.value);else{let J=ge(v,r,a).indexOf(w.value);if(J!==-1)switch(v){case"MMM":case"MMMM":f.set("MM",J+1);break}}}});let p=f.get("HH")||0;m===!1?(p+=p===12?0:12,f.set("HH",p===24?0:p)):m===!0&&p===12&&f.set("HH",0),f.set("MM",(f.get("MM")||1)-1);let[y,S,M,we,Me,ve]=Array.from(f.values()),B=_e(new Date(`${K(y)}-${b(S+1)}-10`));if(B<M&&i==="throw")throw new Error(`Invalid date ${K(y)}-${b(S+1)}-${b(M)}`);M=i==="backward"?Math.min(M,B):M;let De=`${K(y)}-${b(S+1)}-${b(M)}T${b(we)}:${b(Me)}:${b(ve)}${g}`,G=new Date(De);return isFinite(+G)?G:u()}function et(e,n){let r=0,s=a=>[a[r++],a[r]],t=0,i=[],u;do{let[a,l]=s(n);u=l;let c=1;if(a.partName==="literal")c=a.partValue.length;else if(a.token in C)c=C[a.token];else if(l)if(l.partName==="literal"){if(c=e.indexOf(l.partValue,t)-t,c<0)throw new Error}else if(l.partName==="dayPeriod"){for(let o=1;o<=4;o++)if(isNaN(Number(e.charAt(t+o)))){c=o;break}}else{let o=e.substring(t).search(/\d/);o!==-1&&(c=t+o)}else c=e.length;i.push({...a,value:e.substring(t,t+c)}),t+=c}while(u);return i}var V=Q(k()),ye={users:{insert:[{handler:async(e,n)=>{let r=(await n.select({count:pe.sql`cast(count(${A.userId}) as int)`}).from(A))[0].count,s=$(he(e.createdAt??"now"),"medium");return{receivers:["1234"],message:Html.createElement("div",{id:"notifications","hx-swap-oob":"beforeend"},Html.createElement("div",null,"New user ",(0,V.escapeHtml)(e.username)," created at ",(0,V.escapeHtml)(s)," ","There are now ",r," users"))}},name:"web"},{handler:async(e,n)=>{await n.insert(F).values({messageText:`Hi I'm new here! My name is: ${e.username}`,userId:e.userId})},name:"introduction"}],update:[{handler:async e=>{await fetch("https://hooks.slack.com/services/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",{method:"POST",body:JSON.stringify({text:`User ${e.email} was just updated`})})},name:"slack"}]}};var x;try{x=Function("return this")()}catch{x=window}x.Html||(x.Html=k());x.Html.default&&(x.Html=x.Html.default);var tt={...ye,...ie,htmx:{new_chat_message:{handler:async(e,n)=>{await n.insert(F).values({userId:"1d7438c3-87fa-4a90-b049-991dde32dc92",messageText:e.chat_message})},name:"Create chat message"}}};0&&(module.exports={handlers});
